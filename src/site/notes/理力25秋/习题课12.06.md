---
{"dg-publish":true,"permalink":"/理力25秋/习题课12.06/","noteIcon":"default","created":"2025-11-26T20:32:23.570+08:00","updated":"2025-12-06T13:07:06.606+08:00"}
---


尹荣洋	$yry0204@mail.ustc.edu.cn$
# 1 作业中的问题  
##### hw 7  
- 第一次 T 3
![zz_figure/Pasted image 20251128163141.png](/img/user/zz_figure/Pasted%20image%2020251128163141.png)  

<div class="transclusion internal-embed is-loaded"><a class="markdown-embed-link" href="/理力25秋/Answer for HW7/#1-3" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a><div class="markdown-embed">

<div class="markdown-embed-title">

# Answer for HW7

</div>


## 1.3 有心力场  
> [!info]
> 改作业时发现很多同学竟然不会用 $V_{eff}$ 判断轨道是否有界，这是力学的内容。已知  
> $
> E = \frac{1}{2} m \dot{r}^2 + V_{eff}
> \quad\Rightarrow\quad
> 0 = m\dot{r} \frac{ \mathrm{d} \dot{r} }{ \mathrm{d} r} + \frac{ \mathrm{d} V_{eff} }{ \mathrm{d} r}
> $
> 所以  
> - 假设 $\dot{r}>0$，所以朝着物体移动的方向： $r$ 增大的方向，若 $\frac{ \mathrm{d} V_{eff} }{ \mathrm{d} r} > 0$ 也即 $V_{eff}$ 增加就意味着 $\frac{ \mathrm{d} \dot{r} }{ \mathrm{d} r}<0$，即速度减小，粒子被束缚。
> - 假设 $\dot{r}<0$，所以朝着物体移动的方向： $r$ 减小的方向，若 $\frac{ \mathrm{d} V_{eff} }{ \mathrm{d} (-r)} > 0\ or\ \frac{ \mathrm{d} V_{eff} }{ \mathrm{d} r} < 0$ 也即 $V_{eff}$ 增加就意味着 $\frac{ \mathrm{d} \dot{r} }{ \mathrm{d} r}>0\ or\ \frac{ \mathrm{d} \dot{r} }{ \mathrm{d} (-r)}>0$，即速度减小，粒子被束缚。
> 
> 上述的情形对应如下图片当中 $E_1 < E < E_2,r_1<r<r_2$ 的片段：  
> ![zz_figure/Pasted image 20251115144621.png](/img/user/zz_figure/Pasted%20image%2020251115144621.png)
> 
> 画一条水平线，它的纵坐标为 $E$，因为 $E = \frac{1}{2} m \dot{r}^2 + V_{eff}$，所以若此时 $V_{eff}$ 曲线在该水平线下侧，那么水平线与 $V_{eff}$ 曲线的差距就是径向动能 $\frac{1}{2} m\dot{r}^2$，所以若初始时轨道在 $E_1 < E < E_2,r_1<r<r_2$ 的片段，那么运动就无法跨过区间两侧的势垒，否则 $\frac{1}{2} m\dot{r}^2<0$，物体被束缚。  
> 
> 若刚好 $E=E_2$，那么物体就只能待在极小值点，也就是做圆轨道运动。若 $E>E_1$ 并且从 $r<r_1$ 开始运动，那么就可以轻而易举地跨越势垒，导致运动无界。若 $E<E_1$，但物体没有运动到被束缚的区间 $r_1<r<r_2$，而是运动在 $r>r_2$，那么朝着 $r$ 增大的方向，径向动能 $\frac{1}{2} m\dot{r}^2$ 越大，轨道也是无界的。开普勒运动中，就是这样来区分三种轨道的。

#### (a)  线性力 $\vec{F}=-k\vec{r}$, $U=\frac{1}{2}kr^2$  

因为切换大小写过于麻烦，所以以下讨论用 $h$ 代替 $L$，约化质量 $\mu$ 代替 $m$.  

我们使用 binet 微商方程，做如下换元：  
$
u  \equiv \frac{1}{r^2}
$
那么  
$
\frac{ \mathrm{d} u }{ \mathrm{d} \phi} = -\frac{2}{r^3} \frac{ \mathrm{d} r }{ \mathrm{d} \phi}
$
$
\dot{r} = \frac{ \mathrm{d} r }{ \mathrm{d} \phi} \dot{\phi} = -\frac{r^3}{2} \dot{\phi} \frac{ \mathrm{d} u }{ \mathrm{d} \phi} = -\frac{r}{2 } \frac{h}{\mu} \frac{ \mathrm{d} u }{ \mathrm{d} \phi} 
$
同时能量守恒给出：  
$
\frac{1}{2}\mu \dot{r}^2 = \frac{1}{8} \frac{h^2}{u\mu} \left( \frac{ \mathrm{d} u }{ \mathrm{d} \phi} \right)=
E - \frac{h^2}{2\mu} u - \frac{k}{2u}
$
整理第二个等号得到：  
$
\left( \frac{ \mathrm{d} u }{ \mathrm{d} \phi } \right)^2 + 4u^2 - \frac{8E\mu}{h^2}u = -\frac{4k\mu}{h^2}
$
改写为：  
$
\left[ \frac{ \mathrm{d}  }{ \mathrm{d} \phi}\left( u-\frac{E\mu}{h^2} \right) \right]^2 + 4\left( u-\frac{E\mu}{h^2} \right)^2 = -\frac{4k\mu}{h^2} + 4\left( \frac{E\mu}{h^2} \right)$
该方程可分离变量求解，得到：  
$
u = \frac{E\mu}{h^2} + \frac{E\mu}{h^2}\left( 1-\frac{kh^2}{E^2\mu} \right)^{1/2} \cos2(\phi - \phi_0) \equiv \frac{1}{r^2}
$
做换元 $(x,y) = r(\cos\phi,\sin\phi)$ 并取 $\phi_0=0$ 可发现上式为圆锥曲线方程，其离心率满足：  
$
\left( 1-\frac{kh^2}{E^2\mu} \right)^{1/2} = \frac{e^2}{2-e^2}
$
离心率 $e$，或者说 $k$ 的正负(排斥或吸引势)，将确定轨道的形状。注意 $e$ 不但大于 $0$，还要小于 $\sqrt{2}$（因为上式为平方根，要大于 0）。   

此外，本题选用拉格朗日方程的方法可更快得到结果。（采用直角坐标，发现拉格朗日方程就是简谐振动方程） 

#### (b) 球方势阱 $V(r)=-V_{1}(r<a), V(r)=0(r>a)$  
假设 $V_1 > 0$。如果物体的瞄准距离 $d$ 大于 $a$, 显然只会<font color="#ff0000">(1)在球外做直线运动</font>，反之，轨道<font color="#ff0000">(2)在球内发生折射</font>或者<font color="#ff0000">(3)被束缚在球内</font>。

一般来说，可以分三种情形绘制如下 $V_{eff}$，以此确定轨道的有界还是无界，注意对于球外的物体，穿过球体的条件 $d<a$ 等价于 $E = \frac{1}{2}m v_{\infty}^2> \frac{L^2}{2 m a^2}$（对应于下图紫色区域，即 $E> \frac{L^2}{2m a^2}, 存在\ r<a$）  

![zz_figure/Capture_20251115_140716.jpg](/img/user/zz_figure/Capture_20251115_140716.jpg)


#### (c) 反比力  
见 [[理力25秋/Answer for HW6#1.3 T2\|HW6的T2]]，根据 $E$ 和 $\frac{h^2}{2 \mu} - k$ 的正负可确定轨道形状。通过 $V_{eff}$ 作图可以进一步确认轨道是否有界。

#### (d) Yukawa 势 $U(r)=-\frac{ke^{-\alpha r}}{r}$ 
对于 $V_{eff}(r)=\frac{h^2}{2\mu r^2}-\frac{ke^{-\alpha r}}{r}$，有  
$
\frac{ \mathrm{d} V_{eff} }{ \mathrm{d} r} = -\frac{h^2}{\mu r^3} +k e^{-\alpha r} \frac{\alpha r+1}{r^2} = r^{-3} f(r), \ f(r) = ke^{-\alpha r}(\alpha r+1)r- \frac{h^2}{\mu}
$
令 $\frac{ \mathrm{d} V_{eff} }{ \mathrm{d} r}=0$, 可以得到对应圆轨道的半径，在常见情形下($k>0,\alpha > 0$)，该方程有 0~2 个根（对应 $V_{eff}$ 有 0~2 个极值点）。据此可以画出 $V_{eff}(r)$ 的图像，根据直线 $V_{eff}=E$ 在途中的位置，可以将轨道分为几种类型：  

- 无界(类似抛物线/双曲线但与之偏离。或者从无穷远入射，环绕几圈后再返回无穷远); 
- 进动(类椭圆轨道的进动); 
- 圆(特殊情形，但处于势能极大时容易不稳定)。

所以根据 $\frac{ \mathrm{d} V_{eff} }{ \mathrm{d} r}=0$ 根的个数得到如下图： 

![zz_figure/Capture_20251115_141631.jpg](/img/user/zz_figure/Capture_20251115_141631.jpg)

对于最常见的第一种情形，$f(r)$ 在 $[0,+\infty)$ 区间上被 $V_{eff}$ 的两个极值点 $r_1,r_2$ 分割，符号变化为 ${\color{red} -} \to {\color{red} +} \to {\color{red} -}$，$f(r)$ 的极大值点由 $f'(r_0) = 0$ 得到, 为 $r_0 = \frac {{1+\sqrt{5}} }{ 2\alpha }$，由上述几个曲线可知，要使得轨道有界，必须存在 $\frac{ \mathrm{d} V_{eff} }{ \mathrm{d} r}=0$ 或者说存在 $f(r_{1,2}) = 0$ 成立，那么必须有  
$
f(r_0) > 0
$
于是得到  
$
\alpha \frac{h^2}{\mu} < 2(2+\sqrt{5})ke^{-(\sqrt{5}+1)/2}
$
若上式不成立，则轨道无界。反之，三种情况都有可能。


</div></div>


##### hw 8  振动  
- 久期方程的线代原理： $A_{n\times n}\ x = 0$ 有非平凡解的条件：$det(A)=0$ 或者说 $rank(A)<n$，$n-rank(A)$ 为解空间的维数/解的自由度。
- 最后的结果不要包含一堆自设的符号，看不懂

##### hw 9
- T 1  
![zz_figure/Pasted image 20251128163445.png](/img/user/zz_figure/Pasted%20image%2020251128163445.png)

缺少齐次通解(初态解)。为满足意义，最终解要取实部。  

- T 2  
![zz_figure/Pasted image 20251128163454.png](/img/user/zz_figure/Pasted%20image%2020251128163454.png)

格林函数，没学过数学物理方法和复变不建议写，写了也没什么用  

# 2 一些 tips  
#### 怎么记忆几类正则变换  
往年一般是闭卷考，生成函数的公式不会给。  

- 记忆生成函数的自变量：
![zz_figure/302d1b2fe30e55b13aa201f5606fd6e3.jpg](/img/user/zz_figure/302d1b2fe30e55b13aa201f5606fd6e3.jpg)  
- 记忆生成函数的偏导关系

$\delta F$ 无非由以下几项构成：  
$$
p\delta q, \  Q\delta P,\ -q\delta p, \ -P\delta Q
$$
只需要记住前两个，后两个带负号。于是 1~4 类变换对号入座即可。  

- 如果实在不想记，可以只记 $F_2$，前两年都考的第二类，当然今年不确定（我也不敢说绝对）。

#### 怎么证明一个变换是正则变换
有三种方法，最简单也最方便的一种是：保泊松括号/辛结构的变换是正则变换，即只需证明  
$$
{\color{red}[Q_j,P_i] = \delta_{ij}}
\quad
or\quad
[\xi_i,\xi_j] = \omega_{ij}
$$
$\omega_{2s\times 2s} = \begin{bmatrix} 0_{s\times s} & I_{s\times s} \\  -I_{s\times s} & 0_{s\times s} \end{bmatrix}$ 是单位矩阵 $I$ 的辛形式，$\xi_\alpha = (q_1,q_2 \dots, q_s, p_1,p_2 \dots, p_s)^{T}$ 是相空间变量的辛形式。

做题基本上只用到上式的一个等式，下面两种方法通常用不到(不好用)。第二种方法(教材的方法)，以下变分是全微分
$$
p_\alpha \delta q - P\delta Q = \delta F_1(Q,q,t)
$$
这个全微分也可以选取其他三类生成函数。  

第三种方法，保辛的变换是正则变换  
$$
M\omega M^T = \omega
$$
对于变换 $\xi \to \xi'$，$M_{\alpha\beta}=\frac{ \partial \xi'_\beta }{ \partial \xi_\alpha }$ 是变换矩阵的辛形式。你可以把正则变换想象成在相空间做“旋转”，类似在欧式空间的正交变换(即 $RIR^T=I$，参见高显讲义)。  

#### 存在某类正则变换需要什么条件  
![zz_figure/3927208960d53ef1cfdb1fb6d2709e03.jpg](/img/user/zz_figure/3927208960d53ef1cfdb1fb6d2709e03.jpg)

自由条件保证变换可逆/非退化，存在条件保证变量之间的独立性。
# 3 欧式空间的矢量和张量运算
​三维欧几里得空间中，只用<font color="#ff0000">下</font>角 标来表示张量(分量)，如应力张量 ${P}_{ij}$，它是一个二阶张量。

闵氏空间(狭相)和黎曼空间(广相)不在本文的考虑范围内。  

前两节是一些比较枯燥的定义。

## 3.1 基本约定  
- 爱因斯坦求和约定： 除非特殊说明，否则默认对出现两次的相同指标求和，如 $\vec x=x_i\vec e_i=x_1\vec e_1+x_2\vec e_2+x_3\vec e_3$. 偶尔出于某种特殊需要, 相同的指标可能出现三次及以上, 此时也默认求和.

- 单位正交坐标基矢： $\vec e_i$

- 单位并矢：$\vec e_i \vec e_j$。比如一个二阶 $3\times3$ 的矩阵，可以把 $\vec e_i \vec e_j$ 理解为第 $i$  行 $j$ 列为 $1$,其他元素均为 $0$ 的矩阵，或者理解为列向量 $e_i$ 与行向量 $e_j^T$ 的矩阵乘积，或者理解为二阶张量的一个“基”张量（类似于基向量）。类似的可以把更多基矢并在一起，表示更高阶的张量分量。

- 二阶 $kronecker 符号$：$\delta_{ij}=e_i\cdot e_j\overset{\bigtriangleup }{=}I_{ij}(单位矩阵)$

令 $e_i\times e_j=\epsilon_{ijk}e_k$ 得到：

- 三阶 $Levi-Civita$ 符号：
$$
 \epsilon_{ijk}=\left\{\begin{matrix}
 +1\ \ \ \ \ \ \ \ 	当i,j,k为偶排列	\\
 -1\ \ \ \ \ \ \ \ 	当i,j,k为奇排列	\\						0\ \ \ \ \ \ \ \ \ 	当存在相同指标					\end{matrix}\right.
 $$
可以简单地在 $xyz$ 坐标系用右手螺旋验证上述定义的正确性。

直角坐标系下，梯度 $\nabla f=\vec e_i\frac{\partial f}{\partial x_i}\overset{简记为}=\vec e_i\partial_if$

- 所以简记 $nabla$ 算子为 : $\nabla=grad=\frac{\partial}{\partial\vec r}=\vec e_i\partial_i$

## 3.2 已知关系的角标形式
利用上述约定，有：

- 矢量展开 $\vec a=a_i \vec e_i$

- 点乘 $\vec a \cdot \vec b=a_i\vec e_i \cdot b_j \vec e_j =a_ib_j\delta_{ij}=a_ib_i$

- 叉乘 $\vec a \times \vec b=a_i\vec e_i \times b_j \vec e_j =\epsilon_{ijk}a_ib_j\vec e_k\to (\vec a \times \vec b)_k=a_i\vec e_i \times b_j \vec e_j =\epsilon_{ijk}a_ib_j$

- 张量展开 $\boldsymbol{ A}=A_{ij}\vec e_i\vec e_j$

-  $Laplace$ 算符 $\Delta=\nabla^2=\nabla \cdot \nabla=e_i\partial_i \cdot e_j\partial_j=\delta_{ij}\partial_{ij}=\partial_i^2$

- 散度 $div\ \vec v=e_i\partial_i \cdot v_je_j=\partial_iv_i$

- 旋度 $rot\ \vec v=e_i\partial_i \times v_je_j=\epsilon_{ijk}\partial_iv_j$

- 此外，还有一个即将用到的等式 $\epsilon_{ijk}\epsilon_{imn}=\delta_{jm}\delta_{kn}-\delta_{jn}\delta_{km}$

证明它很简单，只需要分别讨论 $(1)j=m,k=n$ 和 $(2)j=n,k=m$ 两种情况。口诀：先对齐再交叉。  

> [!info] 更一般地
> $$
\epsilon_{ijk} \epsilon_{lmn} = \det\begin{pmatrix}
\delta_{il} & \delta_{im} & \delta_{in} \\
\delta_{jl} & \delta_{jm} & \delta_{jn} \\
\delta_{kl} & \delta_{km} & \delta_{kn}
\end{pmatrix}
> $$
> 高维情形：  
> $$  
> \epsilon_{i_1i_2\cdots i_n} \epsilon_{j_1j_2\cdots j_n} = \det\begin{pmatrix}
\delta_{i_1j_1} & \delta_{i_1j_2} & \cdots & \delta_{i_1j_n} \\
\delta_{i_2j_1} & \delta_{i_2j_2} & \cdots & \delta_{i_2j_n} \\
\vdots & \vdots & \ddots & \vdots \\
\delta_{i_nj_1} & \delta_{i_nj_2} & \cdots & \delta_{i_nj_n}
\end{pmatrix}
> $$


## 3.3 矢量运算的基本公式

​	本节略去小写字母头上的矢量箭头。

- 三重积轮换（平行六面体体积）：
$$a\cdot (b\times c)=b\cdot (c\times a)=c\cdot (a\times b)$$
证明：
$$a\cdot (b\times c)=a_k(b\times c)_k=a_kb_ic_j\epsilon_{ijk}=b_i(c_ja_k\epsilon_{jki})=b_i(c\times a)_i=b\cdot (c\times a)$$
- 三叉乘：
$$a\times (b \times c)=b(a\cdot c)-c(a\cdot b)\quad or\quad (b \times c)\times a=c(a\cdot b)-b(a\cdot c)$$
口诀：先中间再外边  

证明：
$$
\begin{array}{l}
a\times (b \times c)
&=\epsilon_{ijk}a_i(b\times c)_je_k \\
&=\epsilon_{ijk}a_i\epsilon_{mnj}b_mc_ne_k \\
&=e_k\epsilon_{jki}\epsilon_{jmn}a_ib_mc_n	\\		
&=(\delta_{km}\delta_{in}-\delta_{kn}\delta_{im})e_ka_ib_mc_n \\
&=e_mb_ma_nc_n-e_nc_na_mb_m \\
&=b(a\cdot c)-c(a\cdot b)
\end{array}
$$
- 叉乘的点乘
$$
(a \times b) \cdot (c \times d) = (a \cdot c)(b \cdot d) - (a \cdot d)(b \cdot c) 
$$
利用三重积轮换得到：
$$
(a \times b) \cdot (c \times d) = a \cdot \left[ b \times (c \times d) \right] = c \cdot \left[ d \times (a \times b) \right]
$$
再利用三叉乘得到：  
$$
a \cdot \left[ b \times (c \times d) \right] = (a \cdot c)(b \cdot d) - (a \cdot d)(b \cdot c) 
$$
更复杂的公式完全可以类似操作。
## 3.4 $\nabla$ 的基本运算
- 梯度场无旋：$\nabla\times\nabla f=0$

证明：
$左侧=\epsilon_{ijk}\partial_i(\nabla f)_je_k=\epsilon_{ijk}\partial_i\partial_jf\ e_k=-\epsilon_{jik}\partial_j\partial_if\ e_k$，默认偏导可以换序，可见对于同一个 $e_k$ 项，$i$ 和 $j$ 互换的两项相消，结果 $=0$.

- 旋度场无散：$\nabla\cdot\nabla\times \vec A=0$

证明： 
$左侧=\partial_k(\nabla\times \vec A)_k=\epsilon_{ijk}\partial_k\partial_iA_j$，你会发现 $i$ 和 $k$ 互换的两项也相消。

 - 类似于函数乘积的微分：
1) $\nabla fg=f\nabla g+g\nabla f$

2) $\nabla\cdot(f\vec A)=f\nabla\cdot \vec A+\vec A\cdot\nabla f$

3) $\nabla\times(f\vec A)=f\nabla\times\vec{A}+\nabla{f}\times{\vec A}$

类似之前的证明，比如证明（3）式:
$左侧=\epsilon_{ijk}\partial_i(fA_j)e_k=f\epsilon_{ijk}(\partial_iA_j)e_k+A_j\epsilon_{ijk}(\partial_if)e_k=右侧$

 - 叉乘的散度：$\nabla\cdot(\vec A\times\vec B)=	\vec B\cdot\nabla\times\vec A-\vec A\cdot\nabla\times\vec B$

 - 叉乘的旋度：$\nabla\times(\vec A\times \vec B)=(\vec B\cdot\nabla)\vec A+(\nabla\cdot\vec B)\vec A-(\vec A\cdot\nabla)\vec B-(\nabla\cdot\vec A)\vec B$

- 点乘的梯度：$\nabla (\vec A\cdot \vec B)=\vec A\times(\nabla\times\vec B)+\vec B\times(\nabla\times\vec A)+(\vec A\cdot\nabla)\vec B+(\vec B\cdot\nabla)\vec A$

- 旋度的旋度：$\nabla \times (\nabla \times \vec A) = \nabla(\nabla \cdot \vec A) - \nabla^2 \vec{A}$

- etc.
​	  
上面没有给证明的几个公式虽说也能用已经提到的方法证明，但还是下面的费曼法更简单：

## 3.5 $\nabla$ 的费曼法分解
已知，$\nabla=\vec e_i\partial_i$，费曼把 $\nabla$ 的矢量属性 $e_i$ 和微分属性 $\partial_i$ 分离开来，让计算变得简单。只需把作用于张量 A 的 $\nabla$ 算子记作 $\nabla_A$，然后当作矢量进行计算，最后把作用不同张量的 $\nabla$ 算子合并，就能得到结果，举个栗子：

证明上述提到的点乘的梯度：$\nabla (\vec A\cdot \vec B)=\vec A\times(\nabla\times\vec B)+\vec B\times(\nabla\times\vec A)+(\vec A\cdot\nabla)\vec B+(\vec B\cdot\nabla)\vec A$

拆分：$\nabla (A\cdot B)=\nabla_A (A\cdot B)+\nabla_B (B\cdot A)$   
$$
\begin{array}{c}
B\times (C \times A)=C(A\cdot B)-A(C\cdot B) \\
\overset{\tiny C\to \nabla_A}{\Rightarrow}
B\times (\nabla_A \times A)=\nabla_A(A\cdot B)-A(\nabla_A\cdot B)		
\\{\Rightarrow}
\nabla_A(A\cdot B)=B\times (\nabla_A \times A)+A(\nabla_A\cdot B)=B\times (\nabla_A \times A)+(B \cdot \nabla_A)A\end{array}
$$
最后一步进行了换序：$A(\nabla_A\cdot B)=(B \cdot \nabla_A)A$，因为 $\nabla_A$ 必须作用于 A 上。

同理：$\nabla_B(B\cdot A)=A\times (\nabla_B \times B)+(A \cdot \nabla_B)B$

于是：$\nabla (A\cdot B)=\nabla_A (A\cdot B)+\nabla_B (B\cdot A)=B\times (\nabla_A \times A)+(B \cdot \nabla_A)A+A\times (\nabla_B \times B)+(A \cdot \nabla_B)B$

$nabla$ 算子合并后：$\nabla (A\cdot B)=B\times (\nabla \times A)+(B \cdot \nabla)A+A\times (\nabla \times B)+(A \cdot \nabla)B$

再举个更简单的例子，证明上面提到的旋度的旋度：$\nabla \times (\nabla \times \vec A) = \nabla(\nabla \cdot \vec A) - \nabla^2 \vec{A}$  

很简单：  
$$
\nabla_A \times (\nabla_A \times \vec A) = (\nabla_A \cdot \vec A)\nabla_A - A(\nabla_A \cdot \nabla_A) = 
\nabla_A(\nabla_A \cdot \vec A) - (\nabla_A\cdot \nabla_A) \vec{A}
$$
于是上式成立。

此外，还有一个有用的结论，与上式相似但区别：$\nabla A^2=\nabla (A\cdot A)=\vec\nabla \vec A \cdot 2\vec A$，标上矢量记号是为了突出这是一个矢量和二阶张量的点乘，结果自然是矢量。

证明：左侧 $=\partial_i(A_jA_j)\vec e_i=2A_j\partial_iA_j\vec e_i=\partial_iA_j\vec e_i\ 2A_k\delta_{jk}=\partial_iA_j\vec e_i\vec e_j\cdot2A_k\vec e_k$

注意 $2\vec A$ 一定是 $\color{red}右乘$ 在 $\vec \nabla \vec A$ 上，即 $上述证明中e_k作用在e_j而不是e_i上。$

​	我不知道费曼是如何一拍脑袋想到这个方法的，事实证明这个方法偶尔会出些问题——为避免它们，最好保证公式左侧的 $\nabla$ 能够作用于所有矢量&张量，以便其矢量属性和微分属性能够“良好地”分离，反例是，对于 $B\times(\nabla\times A)$ 这种形式则尽量不要用费曼法，因为可以看到，$\nabla$ 的矢量属性作用于 B，而微分属性不会作用于 B，那到底要不要保留 $\nabla_B$？其实保不保留都是错的，它的结果是(从点乘的梯度得到)：$\nabla (A\cdot B)-[(B \cdot \nabla)A+A\times (\nabla \times B)+(A \cdot \nabla)B]$，读者可以自行验证。
## 3.6 $\nabla$ 在曲线正交坐标系的表示
​	只考虑正交坐标系(即, 坐标轴两两正交)。

### 3.6.1 拉梅系数
​	（不严格）定义拉梅系数 $h_i$：满足线段微元 $ds^2=h_i^2dr_i^2$，比如笛卡尔坐标系下 $ds^2=dx^2+dy^2+dz^2$, 亦笛卡尔坐标的三个拉梅系数均为 $1$。不难看出，柱坐标和球坐标的拉梅系数如下：

| 柱坐标      |              |
| ----------- | ------------ |
| $h_r$       | 1            |
| $h_\theta$  | $r$          |
| $h_z$       | 1            |
|             |              |
| **球坐标**  |              |
| $h_r$       | $1$          |
| $h_\theta$  | $r$          |
| $h_\varphi$ | $rsin\theta$ |

​	一个结论是，$h_1h_2h_3$ 正是雅可比行列式的值（淑芬 B 2：三重积分），简记为 $J$ 。

### 3.6.2 $\nabla$ 的一般表示
在曲线正交坐标系下, $\nabla$ 的形式发生了一些变化. 这里依旧以梯度作为出发点 :

#### 1) 梯度. 
拉梅系数的定义的另一种写法为：
$$
h_i = \left| \frac{\partial \vec{r}}{\partial r_i} \right|
$$
其中 $\vec{r}$ 是位置矢量, $\vec{r} = r_i\vec e_i$, 其微分形式为：
$$
d\vec{r} = h_i \vec{e}_i dr_i
$$
注意上式中多出的拉梅系数 $h_i$ (比如极坐标的圆弧 $dl=rd\theta$, $r$ 就是那个多出来的拉梅系数). 另外, 在任意坐标系中，梯度算符的定义应满足：
$$
\nabla f \cdot d\vec{r} = df = \frac{\partial f}{\partial r_i} dr_i
$$
假设 $\nabla f$ 表示为：
$$
\nabla f = A_i \vec{e}_i
$$
代入上式得到：
$$
A_i \vec{e}_i \cdot h_j \vec{e}_j dr_j = A_i h_i dr_i = \frac{\partial f}{\partial r_i} dr_i
\quad \Rightarrow \quad A_i = \frac{1}{h_i} \frac{\partial f}{\partial r_i}
$$
因此根据爱因斯坦求和约定，梯度算符可以简写为：
$$
\boxed{
\nabla = \frac{1}{h_i} \vec{e}_i \partial_i 
}
$$
利用拉梅系数, 容易有如下结论:
- 弧微元: $ds_i = h_idr_i$ (不求和)
- 弧长微元: $ds^2 = h_i^2dr_i^2$
- 面微元: $ds_ids_j = h_ih_jdr_idr_j$ (不求和)
- 体积微元: $dV = h_1h_2h_3dr_1dr_2dr_3=|J|dr_1dr_2dr_3$

下面继续推导散度, 旋度, 以及 $\nabla^2$ 的形式. 需要提前注意的是矢量和张量不随坐标系的选取而变化, $\nabla$ 也是类似的(只要不将它展开成分量形式), 也就是说, 类似于 $\nabla\cdot(f\vec A)=f\nabla\cdot \vec A+\vec A\cdot\nabla f$ 的前面提到在直角坐标系中成立的公式, 换到正交曲线坐标依旧成立, 不一样的只是它的展开分量变了.

#### 2) 散度. 
引理 :  $\nabla \cdot\left(\frac{\vec{e_1}}{h_{2} h_{3}}\right)=\nabla \cdot\left(\frac{\vec{e_2}}{h_{3} h_{1}}\right)=\nabla \cdot\left(\frac{\vec{e_3}}{h_{1} h_{2}}\right)=0$, 注意到三个方向平权(谁也不比谁优越), 所以只需要证 $\nabla\cdot\left(\frac{\vec{e_1}}{h_{2} h_{3}}\right)=0$ 即可.

证明 :
$$
\because \nabla=\frac{1}{h_{i}}\vec{{e}}_{i}{\partial_{i}}  \quad\Rightarrow\quad 
\nabla r_{1}=\frac{\vec{{e}}_{1}}{h_{1}} 
$$
$$
\begin{array}{c} 
\nabla \times \nabla v=0 
\quad\Rightarrow\quad 
\nabla \times\left(\frac{\vec{{e}}_{1}}{h_{1}}\right)=\nabla \times\left(\nabla r_{1}\right)=0 
\quad\Rightarrow\quad
\nabla \times\left(\frac{\vec{{e}}_{i}}{h_{i}}\right)=0
\\
\nabla \cdot\left(\frac{\vec{e_1}}{h_{2} h_{3}}\right)
=\nabla \cdot\left(\frac{\vec{e_2}}{h_{2}} \times \frac{\vec{e_3}}{h_{3}}\right)
\quad\overset{ \tiny\nabla\cdot(\vec A\times\vec B)=	\vec B\cdot\nabla\times\vec A-\vec A\cdot\nabla\times\vec B}{=}\quad
\nabla \times\left(\frac{\vec{e_2}}{h_{2}}\right) \cdot \frac{\vec{e_3}}{h_{3}}-\nabla \times\left(\frac{\vec{e_3}}{h_{3}}\right) \cdot \frac{\vec{e_2}}{h_{2}}
=0\ \ 证毕.
\end{array}
$$
接下来尝试将散度展开 :
$$
\begin{array}{l}
\nabla \cdot \vec v 
&= \nabla \cdot v_k \vec e_k \\
&= \nabla\cdot (h_ih_jv_k) \frac{\vec{e_k}}{h_ih_j} \quad(i,j,k互不相同, 对k求和) \\
\end{array}
$$
使用 $\nabla\cdot(f\vec A)=f\nabla\cdot \vec A+\vec A\nabla f$ :
$$
\nabla \cdot \vec v 
= h_ih_jv_k \nabla \cdot \frac{\vec{e_k}}{h_ih_j} + \frac{\vec{e_k}}{h_ih_j}\cdot \nabla (h_ih_jv_k)
$$
第一项根据引理为 $0$, 第二项正常地把 $\nabla$ 展开并保留 $\vec e_k$ 项即可得到 :
$$
\boxed{
\nabla \cdot \vec v 
= \frac{1}{h_ih_jh_k} \partial_k(h_ih_jv_k)
= \frac{1}{|J|} \partial_k(h_ih_jv_k)
\quad(i,j,k互不相同, 对k求和)
}
$$
#### 3) 旋度.

先给出结果 :
$$
\boxed{
\nabla \times \vec v = \frac{1}{|J|}
\left|\begin{array}c 
h_1\vec e_1 & h_2\vec e_2 & h_3\vec e_3 \\
\partial_1 & \partial_2 &  \partial_3 \\
h_1v_1 & h_2v_2 & h_3v_3 
\end{array}\right| \ 
}
$$
[[zz_Excalidraw/Drawing 2024-12-17 22.53.10.excalidraw\|Drawing 2024-12-17 22.53.10.excalidraw]]  
![zz_figure/Pasted image 20251128164359.png](/img/user/zz_figure/Pasted%20image%2020251128164359.png)
$\vec n(S)$ 为某个面元 $\Delta S$ 的正方向, 以环量定义旋度在 $\vec n(S)$ 方向的分量为 $\vec n(S) \cdot \nabla \times \vec v= \lim_{ \Delta S \to 0 } \frac{{\oint_{\partial S}\vec v \cdot d\vec r}}{\Delta S}$, 不妨取 $\vec n(S)$ 为 $\vec e_1$, 于是积分环路变为上图, 即 :
$$
\begin{array}{l}
(\nabla \times \vec v)_1
&= \lim_{ dr \to 0 } \frac{{
(v_2h_2|_{r_3}\mathrm{d}{r_2} - v_2h_2|_{ r_3+dr_3}\mathrm{d}r_2) + (v_3h_3|_{ r_2+dr_2}\mathrm{d}r_3 - v_3h_3|_{ r_2}\mathrm{d}r_3)
}}{h_2h_3dr_2dr_3} \\
&= \lim_{ dr \to 0 } \frac{{
-\partial_3(v_2h_2)\mathrm{d}r_3\mathrm{d}r_2 + \partial_2(v_3h_3)\mathrm{d}r_2\mathrm{d}r_3
}}{h_2h_3dr_2dr_3} \\
&=\frac{h_1}{h_1h_2h_3}(\partial_2(h_3v_3)-\partial_3(h_2v_2))
\end{array}
$$
满足一开始给出的旋度结果的第一个分量. 其他两个分量也可以类似证明.

#### 4) $laplace$ 算符.
这里不需要再引入新的东西, 直接得到:
$$
\nabla^2 v = \nabla \cdot \nabla v = \frac{1}{|J|} \partial_k(h_ih_j(\nabla v)_k) = \frac{1}{|J|} \partial_k\left( \frac{h_ih_j}{h_k}\partial_k v \right)
$$
即 :
$$
\boxed{
\nabla^2 = \frac{1}{|J|} \partial_k\left( \frac{h_ih_j}{h_k}\partial_k \right) \quad(i,j,k互不相同, 对k求和)
}
$$

### 3.6.3 球坐标和柱坐标中 $\nabla$ 的表示：
根据上述讨论可以计算出球坐标和柱坐标中 $\nabla$ 的表示, 这里只写一下结果:

- 柱坐标
$$
\begin{array}{l} 
\nabla = \left( \partial_r, \frac{1}{r}\partial_\theta, \partial_z \right)_{r,\theta,z} \\ 
\nabla \cdot \vec u = \partial_r u_r + \frac{1}{r}(u_r +\partial_\theta u_\theta) + \partial_z u_z \\
\nabla \times \vec u = \frac{1}{r} \begin{vmatrix} \vec e_r & r \vec e_\theta & \vec e_z \\ \partial_r & \partial_\theta &  \partial_z \\ u_r & ru_\theta & u_z \end{vmatrix} \\
\nabla^2 u = \frac{1}{r}\partial_r\left( r\frac{ \partial u }{ \partial r } \right) + \frac{1}{r^2}\frac{ \partial^2 u }{ \partial^2 \theta } + \frac{ \partial^2 u }{ \partial^2 z }
\end{array}
$$
- 球坐标
$$
\begin{array}{l} 
\nabla = \left( \partial_r, \frac{1}{r}\partial_\theta, \frac{1}{r\sin\theta}\partial_\varphi \right)_{r,\theta,\varphi} \\ 
\nabla \cdot \vec u = \frac{1}{r^2}\partial_r(r^2 u_r) + \frac{1}{r\sin\theta}\partial_\theta (\sin\theta u_\theta) + \frac{1}{r\sin\theta} \partial_\varphi u_\varphi \\
\nabla \times \vec u = \frac{1}{r^2\sin\theta} \begin{vmatrix} \vec e_r & r\vec e_\theta & r\sin\theta\vec e_\varphi \\ \partial_r & \partial_\theta &  \partial_\varphi \\ u_r & ru_\theta & r\sin\theta u_\varphi \end{vmatrix} \\
\nabla^2 u = \frac{1}{r^2}\partial_r\left( r^2\frac{ \partial u }{ \partial r } \right) + \frac{1}{r^2\sin\theta}\frac{ \partial  }{ \partial \theta }\left( \sin\theta \frac{ \partial u }{ \partial \theta } \right) + \frac{1}{r^2\sin^2\theta}\frac{ \partial^2 u }{ \partial^2 \varphi }
\end{array}
$$
​
ps. 以上只列出了矢量的梯度散度旋度运算，如果要是对张量，只作用于它的第一个角标即可。
## 3.7 张量运算的注意点
在直角坐标系中, 注意到偏微分符号作用于基矢为 $0$, 即 $\partial_i \vec e_j=0$, 于是在直角坐标系中寻找基本公式会更加简单, 诸如前面提到的:
$$
\begin{array}c
\nabla\cdot\nabla\times \vec A=0\\
\nabla fg=f\nabla g+g\nabla f\\
\nabla\cdot(f\vec A)=f\nabla\cdot \vec A+\vec A\cdot\nabla f\\
\nabla\times(f\vec A)=f\nabla\times\vec{A}+\nabla{f}\times{\vec A}
\end{array}
$$
的关系可以直接将其中的标量换为矢量, 只需要将上式的 $f,g$ 视为 $\vec F, \vec G$ 的一个分量即可:
$$
\begin{array}c
\nabla\times\nabla \vec F=0 \\
\nabla \vec F\vec G= \vec F\nabla \vec G+ \vec G\nabla \vec F\\
\nabla\cdot(\vec F\vec A)=\vec F\nabla\cdot \vec A+\vec A\cdot\nabla \vec F\\
\nabla\times(\vec F\vec A)=\vec F\nabla\times\vec{A}+\nabla{\vec F}\times{\vec A}
\end{array}
$$
可以设想 $f=F_i, g=G_j$, 再取上式的坐标分量, 那么就可以回到前面的结果. 问题是，这样的操作正确吗？

聪明的你或许已经发现, 将前面的方程向张量扩展, 我们要关注的其实只是 $\nabla$ 和张量基矢的关系. 对于梯度, 它不改变基矢量, 所以孤立的 $\nabla f$ 项直接替换为 $\nabla \vec F$. 而散度会作用于遇到的第一个基矢, 比如 $\nabla \cdot \vec A\vec A = \partial_i \vec e_i \cdot A_j \vec e_j A_k\vec e_k = \partial_i (A_iA_k)\vec e_k$, 旋度也是同样作用于第一个遇到的基矢, <font color="#ff0000">这会导致散度和旋度所作用的对象不能直接从标量或矢量替换为高阶的张量</font>. 所以上面的后两个式子 $\nabla\cdot(\vec F\vec A)=\vec F\nabla\cdot \vec A+\vec A\cdot\nabla \vec F$ 和 $\nabla\times(\vec F\vec A)=\vec F\nabla\times\vec{A}+\nabla{\vec F}\times{\vec A}$ 是错误的. 实际的计算结果表明:
$$
\begin{aligned}
\nabla\cdot(\vec F\vec A)
&= \partial_i (F_i \vec A) \\
&= \vec A \ \partial_i F_i + F_i \vec e_i \cdot  \vec e_j\partial_j \vec A \\
&= \vec A\nabla\cdot \vec F+\vec F\cdot\nabla \vec A
\end{aligned}
$$
也可以用费曼法证明：  
$$
\begin{aligned}
\nabla\cdot(\vec F\vec A)
&= \nabla_F\cdot(\vec F\vec A) + \nabla_A\cdot(\vec F\vec A) \\
&= (\nabla_F\cdot\vec F)\vec{A} +  (\nabla_A\cdot\vec F)\vec{A} \\
&= (\nabla_F\cdot\vec F)\vec{A} +  (\vec F\cdot \nabla_A)\vec{A} \\
&= (\nabla_F\cdot\vec F)\vec{A} +  \vec F\cdot \nabla_A\vec{A} \\
&= (\nabla\cdot\vec F)\vec{A} +  \vec F\cdot \nabla\vec{A} \\
\end{aligned}
$$
因为散度作用于张量 $\vec F\vec A$ 的左侧基矢, 并非像之前一样直接跳过 $f$ 而作用于 $\vec A$ 的基矢, 所以导致结果发生改变. 同样
$$
\begin{aligned}
\nabla\times(\vec F\vec A) &= \epsilon_{ijk}\vec{e_k}\partial_i (F_j\vec{A}) \\
&= \vec A \nabla \times \vec F + F_j \epsilon_{ijk}\vec{e_k}\partial_i \vec{A} \\
&= \vec A \nabla \times \vec F - \vec F \times \nabla\vec A
\end{aligned}
$$
不仅将 $\vec F,\vec A$ 调换, 还多出了一个负号. 面对其他的张量公式，上面介绍的两种方法(分量法和费曼法)也可以应付，因此不赘述。

## 3.8 物理人常用的矢量关系
罗列一下个人遇到的一些关系式, 待补充
### 3.8.1 关于位矢 $\vec r$
- $\nabla \cdot \vec r=3$, $\nabla \vec r = \mathbb{I}$, $\nabla \times \vec r = 0$, $\mathbb{I}$ 是单位矢量
- $\nabla r = \frac{\vec r}{r}$, $\nabla \frac{1}{r} = -\frac{\vec{r}}{r^3}$
- $\nabla^2 \left( -\frac{1}{4\pi r} \right) = \nabla \left(  \frac{\vec{r}}{4\pi r^3} \right) = \delta^3(\vec r)$ 
- $\nabla \times f(r)\vec{r} = 0$
### 3.8.2 关于单位张量 $\mathbb{I}$
- $\mathbb{I}:\boldsymbol{F} = \boldsymbol{F}$, $\boldsymbol{F}$ 是二阶及以上张量, $:$ 表示单位张量 $\mathbb{I}$ 的两个指标都拿来做点乘
- $\mathbb{I}:\nabla \vec B = \nabla \cdot \vec B$
- $\nabla \cdot \varphi \mathbb{I} = \nabla \varphi$

### 3.8.3 其他
- $\nabla B^2 = \nabla(\vec B \cdot \vec B)=2\vec B\times(\nabla \times \vec B) + 2\vec B \cdot \nabla \vec B$
